{"version":3,"file":"js/123.5b1e1ab4.js","mappings":"0bA6CA,MAAMA,GAAQC,EAAAA,EAAAA,MAKRC,GAAUC,EAAAA,EAAAA,IAAI,IACdC,EAAQJ,EAAMK,MAAMC,KAAKC,SAASH,MAWlCI,GAAiBL,EAAAA,EAAAA,IAAI,IAC3BM,QAAQC,IAAIV,EAAMK,MAAMC,KAAKC,WAE7BI,EAAAA,EAAAA,KAAU,KACRC,GAAmB,IAErB,MAAMA,EAAoBA,KACxBC,EAAAA,EAAAA,OAAY,CACVC,IAAK,gBACLC,OAAQ,OACRC,QAAS,CACPZ,OAAO,KAGNa,MAAKC,IACJT,QAAQC,IAAI,QACZD,QAAQC,IAAIQ,GACRA,EAAIC,UACNjB,EAAQkB,MAAQF,EAAIG,OACpBb,EAAeY,MAAQlB,EAAQkB,MAAME,KAAIC,GAChCA,EAAKT,MAMhB,IAEDU,OAAMC,IACLhB,QAAQC,IAAI,MACZD,QAAQC,IAAIe,EAAE,GACd,EAOFC,EAAgBC,UACpBlB,QAAQC,IAAI,6BAEMG,EAAAA,EAAAA,OAAY,CAC5BC,IAAK,0BACLC,OAAQ,OACRC,QAAS,CACPZ,OAAO,KAGXQ,GAAmB,EAMfgB,EAAsBC,IAC1BpB,QAAQC,IAAI,WACZD,QAAQC,IAAImB,GACZpB,QAAQC,IAAI,gBACZD,QAAQC,IAAImB,EAAQC,MAChBD,EAAQC,MAAQ,KAClBC,EAAAA,GAAAA,QAAkB,SACX,IAEPA,EAAAA,GAAAA,MAAgB,kBACT,I,u3BCxHX,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://blogfront/./src/components/user/HeadImg.vue","webpack://blogfront/./src/components/user/HeadImg.vue?3e06"],"sourcesContent":["<template>\r\n  <div class=\"headImg container\">\r\n    <!--头图的上传-->\r\n    <div class=\"upload\">\r\n      <el-text>\r\n        或者你可以上传图片:\r\n      </el-text>\r\n      <el-upload\r\n          class=\"avatar-uploader\"\r\n          :data=\"{token}\"\r\n          action=\"/file/headImg\"\r\n          :show-file-list=\"true\"\r\n          :on-success=\"uploadSuccess\"\r\n          :before-upload=\"beforeAvatarUpload\">\r\n        <el-icon class=\"avatar-uploader-icon\">\r\n          <Plus/>\r\n        </el-icon>\r\n      </el-upload>\r\n      <form action=\"/file/avatar\"></form>\r\n    </div>\r\n    <!--下面是头图的预览-->\r\n    <div class=\"demo-image__lazy\">\r\n      <div v-for=\"(item,index) in imgList\" :key=\"index\" class=\"demo-image__preview\">\r\n        <el-image\r\n            :src=\"item.url\"\r\n            lazy\r\n            fit=\"cover\"\r\n            :preview-src-list=\"previewImgList\"\r\n            :initial-index=\"index\"\r\n            :hide-on-click-modal=\"true\"\r\n            :close-on-press-escape=\"true\"\r\n        />\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport {useStore} from \"vuex\";\r\nimport {onMounted, ref,} from 'vue';\r\nimport {UploadProps} from 'element-plus'\r\n\r\nimport {ElMessage} from 'element-plus'\r\n\r\nconst store = useStore();\r\nimport http from '@/common/api/request'\r\n\r\n// @date 2023/5/28 , @author icestone\r\n// TODO 存放头图的list\r\nconst imgList = ref([]);\r\nconst token = store.state.user.userInfo.token;\r\n// 预览图的list,这里应该存放的全是url,例如:\r\n/*const srcList = [\r\n  'https://fuss10.elemecdn.com/a/3f/3302e58f9a181d2509f3dc0fa68b0jpeg.jpeg',\r\n  'https://fuss10.elemecdn.com/1/34/19aa98b1fcb2781c4fba33d850549jpeg.jpeg',\r\n  'https://fuss10.elemecdn.com/0/6f/e35ff375812e6b0020b6b4e8f9583jpeg.jpeg',\r\n  'https://fuss10.elemecdn.com/9/bb/e27858e973f5d7d3904835f46abbdjpeg.jpeg',\r\n  'https://fuss10.elemecdn.com/d/e6/c4d93a3805b3ce3f323f7974e6f78jpeg.jpeg',\r\n  'https://fuss10.elemecdn.com/3/28/bbf893f792f03a54408b3b7a7ebf0jpeg.jpeg',\r\n  'https://fuss10.elemecdn.com/2/11/6535bcfb26e4c79b48ddde44f4b6fjpeg.jpeg',\r\n]*/\r\nconst previewImgList = ref([]);\r\nconsole.log(store.state.user.userInfo)\r\n\r\nonMounted(() => {\r\n  getUserAllHeadImg()\r\n})\r\nconst getUserAllHeadImg = () => {\r\n  http.$axios({\r\n    url: '/user/headImg',\r\n    method: 'POST',\r\n    headers: {\r\n      token: true\r\n    },\r\n  })\r\n      .then(res => {\r\n        console.log(\"res:\")\r\n        console.log(res)\r\n        if (res.success) {\r\n          imgList.value = res.result;\r\n          previewImgList.value = imgList.value.map(item => {\r\n            return item.url\r\n          })\r\n\r\n\r\n        } else {\r\n\r\n        }\r\n      })\r\n      .catch(e => {\r\n        console.log(\"e:\")\r\n        console.log(e)\r\n      })\r\n}\r\n\r\n/* @author icestone , 17:44\r\n * @date 2023/5/28\r\n * TODO 图片上传\r\n*/\r\nconst uploadSuccess = async () => {\r\n  console.log('handleAvatarSuccess')\r\n  // 请求一次后端的token并存入session\r\n  const res = await http.$axios({\r\n    url: '/user/getUserInfByToken',\r\n    method: 'POST',\r\n    headers: {\r\n      token: true\r\n    },\r\n  })\r\n  getUserAllHeadImg();\r\n}\r\n/* @author icestone , 17:45\r\n * @date 2023/5/28\r\n * TODO 图片上传之前的回调\r\n*/\r\nconst beforeAvatarUpload = (rawFile) => {\r\n  console.log(\"rawFile\")\r\n  console.log(rawFile)\r\n  console.log(\"rawFile.size\")\r\n  console.log(rawFile.size)\r\n  if (rawFile.size <= 2000000) {\r\n    ElMessage.success('上传成功')\r\n    return true\r\n  } else {\r\n    ElMessage.error('请选择2mb大小以下的图片')\r\n    return false\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.demo-image__lazy {\r\n  height: 90vh;\r\n  overflow-y: auto;\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  flex-direction: row;\r\n\r\n  .demo-image__preview {\r\n    display: flex;\r\n    width: 50%;\r\n  }\r\n\r\n  .el-image {\r\n    padding: .3rem;\r\n\r\n    img {\r\n      display: flex;\r\n      width: 70%;\r\n    }\r\n  }\r\n}\r\n\r\n.demo-image__lazy .el-image {\r\n  display: block;\r\n  min-height: 200px;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.demo-image__lazy .el-image:last-child {\r\n  margin-bottom: 0;\r\n}\r\n</style>\r\n","import script from \"./HeadImg.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./HeadImg.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./HeadImg.vue?vue&type=style&index=0&id=ebfdc4ee&scoped=true&lang=less\"\n\nimport exportComponent from \"D:\\\\githubClone\\\\iceYouBlog\\\\blogfront\\\\node_modules\\\\.store\\\\vue-loader@17.1.1\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-ebfdc4ee\"]])\n\nexport default __exports__"],"names":["store","useStore","imgList","ref","token","state","user","userInfo","previewImgList","console","log","onMounted","getUserAllHeadImg","http","url","method","headers","then","res","success","value","result","map","item","catch","e","uploadSuccess","async","beforeAvatarUpload","rawFile","size","ElMessage","__exports__"],"sourceRoot":""}