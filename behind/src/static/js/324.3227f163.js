"use strict";(self["webpackChunkblogfront"]=self["webpackChunkblogfront"]||[]).push([[324],{1324:function(e,a,t){t.r(a),t.d(a,{default:function(){return h}});var l=t(4535);const o={class:"vEdit"},d={class:"demo-image__lazy"},i=["onClick"];function n(e,a,t,n,m,s){const r=(0,l.up)("v-md-editor"),u=(0,l.up)("el-input"),c=(0,l.up)("el-form-item"),h=(0,l.up)("el-button"),w=(0,l.up)("el-form"),g=(0,l.up)("el-drawer"),p=(0,l.up)("el-image");return(0,l.wg)(),(0,l.iD)("div",o,[(0,l.Wm)(r,{"include-level":[3,4,5],onSave:a[0]||(a[0]=e=>m.drawer=!0),modelValue:m.markdownData.content,"onUpdate:modelValue":a[1]||(a[1]=e=>m.markdownData.content=e),"disabled-menus":[],onUploadImage:s.handleUploadImage},null,8,["modelValue","onUploadImage"]),(0,l.Wm)(g,{modelValue:m.drawer,"onUpdate:modelValue":a[9]||(a[9]=e=>m.drawer=e),title:"填写关于该文章的其他信息",size:"70%",direction:"ttb","with-header":!1},{default:(0,l.w5)((()=>[(0,l.Wm)(w,null,{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"文章标题","label-width":"100px"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:m.markdownData.title,"onUpdate:modelValue":a[2]||(a[2]=e=>m.markdownData.title=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(c,{label:"文章描述","label-width":"100px"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:m.markdownData.description,"onUpdate:modelValue":a[3]||(a[3]=e=>m.markdownData.description=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(c,{label:"文章tag1","label-width":"100px"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:m.markdownData.tag1,"onUpdate:modelValue":a[4]||(a[4]=e=>m.markdownData.tag1=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(c,{label:"文章tag2","label-width":"100px"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:m.markdownData.tag2,"onUpdate:modelValue":a[5]||(a[5]=e=>m.markdownData.tag2=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(c,{label:"文章tag3","label-width":"100px"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:m.markdownData.tag3,"onUpdate:modelValue":a[6]||(a[6]=e=>m.markdownData.tag3=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(c,{label:"headImg","label-width":"100px"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:m.markdownData.headImg,"onUpdate:modelValue":a[7]||(a[7]=e=>m.markdownData.headImg=e),autocomplete:"off"},null,8,["modelValue"]),(0,l.Wm)(h,{onClick:s.selectHeadImg},{default:(0,l.w5)((()=>[(0,l.Uk)("选择图片")])),_:1},8,["onClick"])])),_:1})])),_:1}),(0,l.Wm)(h,{onClick:a[8]||(a[8]=e=>m.drawer=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("再想想")])),_:1}),(0,l.Wm)(h,{onClick:s.submit},{default:(0,l.w5)((()=>[(0,l.Uk)("提交")])),_:1},8,["onClick"])])),_:1},8,["modelValue"]),(0,l.Wm)(g,{modelValue:m.headImgDrawer,"onUpdate:modelValue":a[10]||(a[10]=e=>m.headImgDrawer=e),title:"选择你的头图",size:"90%",direction:"ttb","with-header":!1},{default:(0,l.w5)((()=>[(0,l.Uk)(" 选择你的头图 "),(0,l._)("div",d,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(m.headImgList,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{key:a,class:"demo-image__preview",onClick:a=>s.setHeadImg(e.url)},[(0,l.Wm)(p,{src:e.url,lazy:"",fit:"cover","preview-src-list":m.previewImgList,"initial-index":a,"hide-on-click-modal":!0,"close-on-press-escape":!0},null,8,["src","preview-src-list","initial-index"])],8,i)))),128))])])),_:1},8,["modelValue"])])}var m=t(9510),s=t(1112),r={name:"Vedit",created(){this.initMarkdownData()},data(){return{id:0,markdownData:{content:"> hello world!\n\ntype you first line code\n",title:"请输入你的标题",description:"这是我新建的文章",tag1:"",tag2:"",tag3:"",headImg:""},drawer:!1,headImgDrawer:!1,headImgList:[],previewImgList:[],toolbar:{customToolbar1:{title:"基础工具栏",icon:"v-md-icon-tip",action(e){e.insert((function(e){const a="(((",t=")))",l="请输入文本",o=e||l;return{text:`${a}${o}${t}`,selected:o}}))}}}}},methods:{setHeadImg(e){this.markdownData.headImg=e},selectHeadImg(){this.headImgDrawer=!0,m.Z.$axios({url:"/user/headImg",method:"POST",headers:{token:!0}}).then((e=>{console.log("res:"),console.log(e),e.success&&(this.headImgList=e.result,this.previewImgList=this.headImgList.map((e=>e.url)))})).catch((e=>{console.log("e:"),console.log(e)}))},handleUploadImage(e,a,t){console.log("files"),console.log(t);let l=new FormData;l.append("file",t),a({url:"/images/2.png",desc:"回显图片名称"})},initMarkdownData(){this.id=this.$route.query.id||"0",0==this.id||m.Z.$axios({url:"/markdownFile/getData",method:"POST",headers:{token:!0},data:{id:this.id}}).then((e=>{this.markdownData=e.result})).catch((e=>{this.alertMessage(e)}))},submit(){0==this.id?m.Z.$axios({url:"/new/markdown",method:"POST",headers:{token:!0},data:this.markdownData}).then((e=>{this.drawer=!1,e.success&&this.alertMessage(e.message)})).catch((e=>{this.alertMessage(e)})):m.Z.$axios({url:"/markdownFile/update",method:"POST",headers:{token:!0},data:{markdownData:this.markdownData}}).then((e=>{this.drawer=!1,e.success&&(this.alertMessage("数据更新","success","#a1c4fd"),this.initMarkdownData())})).catch((e=>{this.alertMessage("保存失败",e)}))},alertMessage(e,a,t){const o=t||"red";(0,s.z8)({message:(0,l.h)("p",null,[(0,l.h)("span",null,e),(0,l.h)("i",{style:`color: ${o}`},a)])})}}},u=t(8696);const c=(0,u.Z)(r,[["render",n],["__scopeId","data-v-11ae15a0"]]);var h=c}}]);
//# sourceMappingURL=324.3227f163.js.map